# Plant CYPome Explorer (CYPomeExplorer)

**Plant CYPome Explorer** is a high-resolution computational framework for **functional mapping** and **substrate-compatibility screening** across the plant **Cytochrome P450 (CYP)** superfamily. It uses **Binding Site Vectors (BSVs)**—a structure/ensemble-based descriptor of active-site **geometry** and **electrostatics**—to move beyond sequence-identity heuristics when prioritizing CYP candidates for **specialized metabolism**, **synthetic biology**, and **protein engineering**.

---

## Why this exists: beyond sequence identity

Traditional CYP classification (family/subfamily thresholds based on sequence identity) supports evolutionary labeling but often fails to predict **substrate specificity**, **regioselectivity**, and **metabolic function**, because CYP catalysis depends strongly on **active-site topology**, **access channels**, and **conformational plasticity**.

This project supports:
- **Metabolic engineering**: nominate candidate CYPs in complex plant pathways (e.g., sterol-derived or terpene-derived biosyntheses).
- **Protein engineering**: rationalize/select variants for altered selectivity or promiscuity using pocket-level signals.

---

## Core method: Binding Site Vectors (BSVs)

A **BSV** is generated by tracing fixed-index rays from a defined anchor (typically the **heme iron**, or a user-defined anchor) to the **first intersected atomic van der Waals surface**. Each direction yields:

- **Vector length (`l`)**: local pocket geometry along that direction.
- **Associated partial charge (`q`)**: electrostatic annotation of the intersected atom (charge model depends on your parametrization).

### Similarity metric (shape + charge)
Binding sites are compared by **normalized RMSD** across vectors, with optional weighting to emphasize **shape** vs **electrostatics**. This yields pocket similarity trees and clusters that can diverge meaningfully from sequence or backbone-based relationships.

---

## Plant-specific handling

Most plant CYPs are available as **predicted structures** (e.g., AlphaFold-class models) and often lack cofactors/ligands. To make BSVs comparable across a CYPome, CYPomeExplorer standardizes:

- **Reference alignment**: align all CYPs to a chosen reference frame (commonly a heme-containing CYP template) so that vector indices are comparable.
- **Heme anchoring strategy**:
  - **heme-present structures**: use Fe coordinates directly.
  - **heme-absent models**: infer/transfer an Fe anchor via alignment to the reference geometry (explicitly documented in outputs).

---

## Docking integration: compatibility screening (not ΔG)

CYPomeExplorer is designed to integrate with batch docking/pose generation for **CYP × metabolite** screening.

### Binary/compatibility criterion (pose triage)
Rather than claiming a binding free energy, CYPomeExplorer supports a **compatibility filter**:
- generate (or import) a docked pose for a ligand (3D coordinates required),
- compare ligand volume/pose geometry against the pocket’s BSV-defined surface (steric feasibility),
- optionally summarize **ensemble support** (fraction of conformations that accommodate a pose) as a **conformational availability** signal.

**Interpretation**: this is a screening/prioritization signal, not a direct estimate of affinity.

---

## Technical ecosystem

CYPomeExplorer is backend-flexible. Depending on your installation and desired fidelity, you can use:

### (A) BSV generation backends
- **Native Python implementation (default)**: fast descriptor generation from PDB/mmCIF + chosen charge model.
- **GROMOS++ `pocket` backend (optional)**: reproduces published BSV generation logic if you already use the GROMOS ecosystem.

### (B) Ensemble generation (optional)
- **GROMACS / GROMOS**: generate conformational ensembles for CYPs when dynamics matter.
- Any MD engine is acceptable as long as structures are aligned and charges are consistently defined.

### (C) Analysis + clustering
- Pairwise distance matrices, hierarchical clustering, and exemplar/state discovery (e.g., Affinity Propagation) for ensemble-aware landscape mapping.

---

## Inputs

- **Proteins**
  - Structures: `PDB` / `mmCIF` (static) and/or trajectory snapshots/exemplars
  - Sequences: `FASTA` (optional; for annotation and phylogenetic context)
- **Ligands**
  - `SMILES` (for storage/enumeration) → **must be converted to 3D** for docking/pose screening
  - Docked poses: `SDF` / `MOL2` / `PDB` (recommended)

---

## Outputs

- **BSV descriptors** (per CYP, per conformation/exemplar)
- **Distance matrices** (shape-only, charge-only, combined/weighted)
- **Functional similarity trees** (dendrograms) and clusters
- **Compatibility rankings** for CYP × ligand (optionally ensemble-weighted)

---

## Example use case: Tacca CYP screening (metabolic engineering)

Use CYPomeExplorer to prioritize **Tacca** CYP450s against bulky **phytosterol** or **taccalonolide-pathway** intermediates:
1. standardize structures + anchors,
2. compute BSVs (static and/or ensemble),
3. dock intermediates (3D required),
4. triage poses by BSV compatibility and ensemble support,
5. nominate top CYPs for biochemical validation.

---

## Citation

If you use the BSV framework for functional grouping or pocket-based screening, cite:
- **Kuvek, T., et al. (2026). _Binding Site Vectors Enable Mapping of Cytochrome P450 Functional Landscapes_. Journal of Chemical Information and Modeling.**
